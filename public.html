<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Premium Upgrade -</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: green;
      margin: 0;
      padding: 0;
    }

    .container {
      text-align: center;
      padding: 50px 20px;
    }

    h1 {
      color: yellow;
    }

    .open-modal-btn {
      background-color: #007bff;
      color: #fff;
      border: none;
      padding: 14px 24px;
      border-radius: 8px;
      font-size: 16px;
      cursor: pointer;
    }
    .modal {
  display: none;
  position: fixed;
  inset: 0;            /* shorthand for top:0 right:0 bottom:0 left:0          */
  z-index: 999;
  /* remove the padding-top that created a gap */
  /* padding-top: 60px;       <-- delete this   */
  width: 100%;
  height: 100%;
  overflow: auto;
  background: rgba(0,128,0,.9);  /* keep green but add transparency if you like */
}


/* content inside the modal */
modal .modal-content {
  /* pick a size that feels right for your UI */
  font-size: 1.25rem;   /* â‰ˆ 20 px */
  /* optional readability tweaks */
  line-height: 1.6;
  color: #fff;
  padding: 1.5rem;
}
/* clean blockâ€”delete the extra brace thatâ€™s after this rule */
.modal-content{
  position: relative;
  background:#fff;
  margin:auto;
  margin-top: 30px;
  padding:30px;
  border-radius:12px;
  text-align:center;
  animation:fadeIn .3s ease-in-out;
  max-height:90vh;
  overflow-y:auto;
  width:90%;
  max-width:600px;
}  /* <-- make sure this is the only closing brace */

    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .close-btn {
      color: #aaa;
      font-size: 28px;
      position: absolute;
      top: 10px;
      right: 20px;
      cursor: pointer;
    }

    ul {
      list-style: none;
      padding-left: 0;
      text-align: left;
    }

    ul li::before {
      content: "âœ“ ";
      color: green;
    }

    .payment-info {
      text-align: left;
      margin-top: 20px;
    }

    textarea, input {
      width: 100%;
      margin-top: 15px;
      padding: 12px;
      font-size: 14px;
      border: 1px solid #ccc;
      border-radius: 8px;
    }

    .btn-verify, .btn-login {
      background-color: #28a745;
      color: white;
      padding: 12px 20px;
      border: none;
      border-radius: 6px;
      margin-top: 15px;
      font-size: 16px;
      cursor: pointer;
    }

    .btn-verify:hover, .btn-login:hover {
      background-color: #218838;
    }

    #loginForm {
      margin-top: 20px;
      display: none;
    }

    #logCode {
      font-weight: bold;
      color: #007bff;
      margin-top: 10px;
    }
    p.animated-text {
      font-size: 24px;
      font-weight: bold;
      color: #333;
      animation: moveZoomColor 3s infinite alternate ease-in-out;
      display: inline-block;
    }

    @keyframes moveZoomColor {
      0% {
        transform: translateX(0) scale(1) translateY(0);
        color: #ff6600;
      }
      25% {
        transform: translateX(20px) scale(1.1) translateY(-5px);
        color: #33cc33;
      }
      50% {
        transform: translateX(40px) scale(1) translateY(5px);
        color: #0066ff;
      }
      75% {
        transform: translateX(20px) scale(1.1) translateY(-5px);
        color: #cc00cc;
      }
      100% {
        transform: translateX(0) scale(1) translateY(0);
        color: #ff6600;
      }
    
  </style>
</head>
<body>
<div class="container"
     style="max-width:350px;margin:3rem auto;padding:2rem 2.5rem;text-align:center;
            border-radius:1.25rem;box-shadow:0 8px 20px rgba(0,0,0,.08);
            background:green;font-family:system-ui,sans-serif;">
  <h1 style="margin:0 0 .85rem;font-size:1.99rem;font-weight:700;color:#111827;">
    ðŸ‘‘ Upgrade to Premium
  </h1>
  <p style="margin:0 0 1.56rem;font-size:1rem;color:yellow;">
    Unlock advanced tools for better prediction &amp; analysis
  </p>

  <button class="open-modal-btn"
          onclick="openModal('premiumModal')"
          style="padding:.75rem 1.5rem;font-size:1rem;font-weight:600;border:none;
                 border-radius:.75rem;cursor:pointer;transition:background .2s ease;
                 background:#3b82f6;color:#ffffff;">
    âœ¨ See Premium Features
  </button>
</div>

  <!-- Premium Modal -->
  <div id="premiumModal" class="modal">
    <div class="modal-content">
      <span class="close-btn" onclick="closeModal('premiumModal')">&times;</span>
      <h2 style="margin:0 0 8px; line-height:1.2;">
  Upgrade to Premium â€“ Only Ksh 99
</h2>

<p class="animated-text" style="margin:0 0 6px; line-height:1.25;">
  Unlock these exclusive features:
</p>
<ul>
        <li>Predict match results based on odds.</li>
        <li>Predict Both Teams to Score (GG).</li>
        <li>Predict Over/Under 2.5 goals.</li>
        <li>View results in a clean dashboard.</li>
        <li>Enter and save final match results.</li>
        <li>Persist results via localStorage.</li>
      </ul>
      <hr>
      <div class="payment-info"><!-- inside .payment-info -->
<p><strong>Go to M-Pesa â€º Lipa na M-Pesa â€º Buy Goods and Services</strong></p>
<p>
  <strong>Till&nbsp;Number:</strong>
  <span style="color:green;">4585402</span><br>
  <small style="color:#555;">
    (Copy the Till number, then paste it into your SIM-Toolkit for easy payment)
  </small>
</p>
<p><strong>Recipient Name:</strong> Emanuel</p>
      
      <textarea id="mpesaMessage" rows="5" placeholder="Paste your full M-Pesa message here..."></textarea>
      <button onclick="verifyMpesaMessage()" class="btn-verify">Verify Now</button>

      <p id="logCode"></p>

      <div id="loginForm">
        <input type="text" id="username" placeholder="Enter your phone number or name" required />
        <input type="password" id="password" placeholder="Enter Log Code" required />
        <button onclick="login()" class="btn-login">Login to Dashboard</button>
      </div>
    </div>
  </div>

  <script>
   function openModal(id) {
  document.getElementById(id).style.display = 'block';
}

function closeModal(id) {
  document.getElementById(id).style.display = 'none';
}

function generateLogCode() {
  return 'PREM-' + Math.floor(100000 + Math.random() * 900000);
}
function verifyMpesaMessage() {
  document.getElementById("mpesaMessage").readOnly = true;
  const raw = document.getElementById("mpesaMessage").value.trim();
  const logCodeElem = document.getElementById("logCode");
  const loginForm = document.getElementById("loginForm");

  // Extract transaction code: 10 uppercase alphanumeric characters
// Extract transaction code: 10 uppercase alphanumeric characters
const trxMatch = raw.match(/\b([A-Z0-9]{10})\b/);
const trxCode  = trxMatch ? trxMatch[1] : null;

// Validate exact amount: "Ksh 99.00"
const amtMatch = /\bKsh\s*99\.00\b/i.test(raw);

// Validate recipient name: must contain "Emanuel"
const nameMatch = /Emanuel/i.test(raw);

// Load used transaction codes safely from localStorage
let usedTrxCodes = [];
try { usedTrxCodes = JSON.parse(localStorage.getItem("usedTrxCodes")) || []; }
catch { usedTrxCodes = []; }

if (trxCode && amtMatch && nameMatch && !usedTrxCodes.includes(trxCode)) {
  // Generate and display log code
  const logCode = generateLogCode();
  logCodeElem.innerHTML =
    `Your Log Code:<br><span style="font-size:18px">${logCode}</span>`;
  document.getElementById("password").value = logCode;
  loginForm.style.display = "block";

  // Save used trx code and log code with timestamp
  usedTrxCodes.push(trxCode);
  localStorage.setItem("usedTrxCodes", JSON.stringify(usedTrxCodes));
  localStorage.setItem("mchangoLogCode", logCode);
  localStorage.setItem("mchangoLogTime", Date.now().toString());

} else if (trxCode && usedTrxCodes.includes(trxCode)) {
  logCodeElem.innerHTML =
    `<span style="color:red">This M-Pesa transaction has already been used.</span>`;
  loginForm.style.display = "none";

} else {
  logCodeElem.innerHTML =
    `<span style="color:red">Invalid message. Make sure it includes Ksh 99.00 and the name Emanuel, then paste the full M-Pesa message here.</span>`;
  loginForm.style.display = "none";
}
}


function validatePhoneNumber(phone) {
  // Kenyan phone number validation: starts with 07 and 10 digits total
  const phoneRegex = /^07\d{8}$/;
  return phoneRegex.test(phone);
}

function login() {
  const username = document.getElementById("username").value.trim();
  const password = document.getElementById("password").value.trim();
  const expectedCode = localStorage.getItem("mchangoLogCode");
  const savedTime = localStorage.getItem("mchangoLogTime");
  const now = Date.now();

  if (!username) {
    alert("Please enter your phone number.");
    return;
  }

  if (!validatePhoneNumber(username)) {
    alert("Please enter a valid phone number starting with 07 and 10 digits long.");
    return;
  }

  if (!expectedCode || !savedTime) {
    alert("Your log code has expired or not found. Please verify your M-Pesa message again.");
    return;
  }

  // Check if log code is older than 6 days (in ms)
  const sixDaysMs = 6 * 24 * 60 * 60 * 1000;
  if (now - parseInt(savedTime, 10) > sixDaysMs) {
    alert("Your log code has expired. Please verify your M-Pesa message again.");
    localStorage.removeItem("mchangoLogCode");
    localStorage.removeItem("mchangoLogTime");
    return;
  }

  if (password === expectedCode) {
    alert("Login successful! Redirecting to dashboard...");
    window.location.href = "fin.html";
  } else {
    alert("Invalid login details. Please make sure your log code is correct.");
  }
}
function initLoginForm() {
  const loginForm   = document.getElementById("loginForm");
  const savedCode   = localStorage.getItem("mchangoLogCode");
  const savedTime   = localStorage.getItem("mchangoLogTime");
  const now         = Date.now();
  const sixDaysMs   = 6 * 24 * 60 * 60 * 1000;

  if (savedCode && savedTime && (now - parseInt(savedTime, 10) <= sixDaysMs)) {
    // still valid â†’ show form & pre-fill code
    loginForm.style.display = "block";
    document.getElementById("password").value = savedCode;
  } else {
    // expired / missing â†’ clean up & keep form hidden
    localStorage.removeItem("mchangoLogCode");
    localStorage.removeItem("mchangoLogTime");
    loginForm.style.display = "none";
  }
}
// Close modal if clicking outside content
window.onclick = function(event) {
  const modal = document.getElementById('premiumModal');
  if (event.target === modal) {
    modal.style.display = "none";
  }
  // Run the init check when the page loads
initLoginForm();
};

  
  </script>

</body>
  </html>
